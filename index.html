<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Apple Card â€“ Demo</title>
<style>
  :root{
    --bg: #0a0a0a;
    --card-bg: #111214;
    --tile: rgba(255,255,255,.06);
    --tileBorder: rgba(255,255,255,.08);
    --text: #fff;
    --subtle: rgba(255,255,255,.65);
    --muted: rgba(255,255,255,.45);
    --accent: #0a84ff;
    --success: #34c759;
    --black: #000;
    --shadow: 0 10px 30px rgba(0,0,0,.22);
    --radius: 18px;
    --t: 240ms cubic-bezier(.22,.61,.36,1);
    --ringTrack: rgba(0,0,0,.08);
    --ringWhite: rgba(255,255,255,.9);
    --appleGradient: radial-gradient(120% 120% at 0% 100%, #ffa1e2 0%, #ffb8d6 10%,
                       #ffc7a1 25%, #ffcd75 38%, #ffb151 55%, #ff9f2b 70%, #f7a63c 82%,
                       #fdbb2d 100%);
    --walletDepth: 22px;
  }

  *{ box-sizing:border-box }
  html,body{ height:100%; background:#000; }
  body{
    margin:0;
    color:var(--text);
    font: 15px -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Helvetica,Arial,sans-serif;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    background: #000;
  }

  /* App frame */
  .app{
    position:relative;
    margin:0 auto;
    max-width:420px;
    height:100vh;
    background: #0b0b0b;
    color:#fff;
    overflow:hidden;
  }

  /* Screens + transitions */
  .screens{
    display:flex;
    width:300%;
    height:100%;
    transition: transform var(--t);
  }
  .screen{
    width:100%;
    height:100%;
    overflow:auto;
    padding-bottom:32px;
    background: linear-gradient(#0b0b0b, #0b0b0b 50%, #0a0a0a);
  }
  .screen::-webkit-scrollbar{ width:0; height:0 }

  .nav{
    position:sticky; top:0;
    z-index:5;
    display:flex; align-items:center; justify-content:space-between;
    padding:14px 16px 10px;
    background: linear-gradient(180deg, rgba(11,11,11,.9), rgba(11,11,11,.55) 35%, transparent);
    -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px);
  }
  .nav h1{
    margin:0; font-weight:700; letter-spacing:.2px; font-size:28px;
  }
  .iconbar{ display:flex; align-items:center; gap:10px; }
  .pillButton{
    border-radius:999px; border:1px solid rgba(255,255,255,.12);
    padding:6px 10px; font-weight:600; background:rgba(255,255,255,.06);
    transition: all var(--t);
  }
  .iconBtn{
    width:34px; height:34px; border-radius:999px;
    display:grid; place-items:center;
    background:rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.12);
    transition: transform var(--t), background var(--t), opacity var(--t);
  }
  .iconBtn:active{ transform:scale(.96) }

  /* Wallet stack */
  .walletStack{
    padding: 6px 12px 24px;
  }
  .walletCard{
    position:relative;
    height:188px;
    border-radius:18px;
    overflow:hidden;
    box-shadow: var(--shadow);
    transform: translateY(0) translateZ(0);
    transition: transform var(--t), box-shadow var(--t), filter var(--t);
    cursor:pointer;
  }
  .walletCard + .walletCard{ margin-top: -120px }
  .walletCard:is(:hover,:focus-visible){ filter:brightness(1.02) }

  .applecard{
    background: radial-gradient(140% 120% at 0% 100%, #ffbdee 0%, #ffc4e2 12%,
                #ffd6b7 28%, #ffd089 44%, #ffb86a 60%, #ff9f43 80%, #ff9d2f 100%);
  }
  .cardChrome{
    position:absolute; inset:0; padding:16px;
    background:
      radial-gradient(120px 120px at 85% 80%, rgba(255,255,255,.25), transparent 60%) no-repeat;
  }
  .appleLogo{
    width:26px; height:26px; opacity:.92;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,.2));
  }
  .brandDots{
    position:absolute; right:18px; bottom:18px; opacity:.9;
  }

  .walletLabel{
    position:absolute; left:16px; bottom:14px;
    font-weight:700; font-size:18px; letter-spacing:.2px;
    text-shadow:0 2px 10px rgba(0,0,0,.3);
  }

  /* Tap hint */
  .tapHint{
    color:var(--subtle); text-align:center; margin:16px 0 8px; font-size:13px;
  }

  /* Card Dashboard */
  .content{ padding:12px 14px 26px }
  .bigCard{
    height:180px; border-radius:20px; overflow:hidden; box-shadow: var(--shadow);
    background: var(--appleGradient);
    position:relative;
  }
  .bigCard .appleLogo{ position:absolute; left:16px; top:14px }
  .bigCard .brandDots{ right:20px; bottom:18px }
  .grid{
    display:grid; gap:12px; margin-top:12px;
    grid-template-columns: 1fr 1fr;
  }
  .tile{
    background: var(--tile);
    border:1px solid var(--tileBorder);
    border-radius:16px; padding:14px;
    transition: background var(--t), border-color var(--t), transform var(--t);
  }
  .tile:active{ transform:scale(.99) }

  .tile.full{ grid-column:1 / -1 }
  .kb{ font-size:13px; color:var(--muted); margin-bottom:4px }
  .val{ font-weight:800; font-size:26px; letter-spacing:.2px }
  .val small{ font-size:12px; color:var(--muted); font-weight:600; display:block; margin-top:4px }
  .payBtn{
    width:64px; height:64px; border-radius:999px; background:#000; color:#fff;
    border:none; font-weight:700; font-size:17px; display:grid; place-items:center;
    margin-left:auto; box-shadow: 0 10px 20px rgba(0,0,0,.35); transition: transform var(--t), background var(--t), opacity var(--t);
  }
  .payBtn:active{ transform: scale(.97) }

  .bars{ display:flex; gap:4px; margin-top:6px }
  .bars i{
    width:100%; height:26px; border-radius:6px;
    background: linear-gradient( 180deg, rgba(255,255,255,.75), rgba(255,255,255,.45));
    mix-blend-mode: overlay; opacity:.25;
    animation: grow 1200ms var(--t) both;
  }
  @keyframes grow{
    from{ transform:scaleY(.2); transform-origin: bottom }
    to{ transform:scaleY(1) }
  }

  .list{
    margin-top:8px;
    background: var(--tile);
    border:1px solid var(--tileBorder);
    border-radius:16px; overflow:hidden;
  }
  .row{
    display:flex; gap:12px; align-items:center;
    padding:14px 14px;
    border-top:1px solid rgba(255,255,255,.06);
  }
  .row:first-child{ border-top:0 }
  .badge{
    width:34px; height:34px; border-radius:9px; display:grid; place-items:center;
    background:#111; border:1px solid rgba(255,255,255,.16);
  }
  .row .title{ font-weight:700 }
  .row .sub{ color:var(--muted); font-size:12px }

  /* Pay Sheet */
  .sheet{
    position:fixed; inset:0; display:grid; place-items:end center;
    pointer-events:none; z-index:20;
  }
  .sheet.active{ pointer-events:auto }
  .dim{
    position:absolute; inset:0; background: rgba(0,0,0,.45);
    opacity:0; transition: opacity var(--t);
  }
  .sheet.active .dim{ opacity:1 }
  .panel{
    width:100%; max-width:420px;
    background: #fff; color:#000; border-radius:16px 16px 0 0;
    transform: translateY(100%);
    transition: transform var(--t);
    box-shadow: 0 -20px 40px rgba(0,0,0,.35);
  }
  .sheet.active .panel{ transform: translateY(0) }
  .payHeader{
    padding:16px; text-align:center; font-weight:800; font-size:22px;
  }
  .subDue{ color:#666; font-size:13px; margin-top:-8px; margin-bottom:6px; text-align:center }

  .ringWrap{
    position:relative; width:86%; max-width:360px; aspect-ratio:1/1;
    margin:2px auto 4px;
  }
  .ringWrap svg{ width:100%; height:100%; overflow:visible }
  .ringText{
    position:absolute; inset:0; display:grid; place-items:center;
    font-weight:800; font-size:44px; letter-spacing:.2px;
  }
  .ringText small{
    position:absolute; bottom:19%; width:100%;
    text-align:center; font-size:11px; color:#777; font-weight:700; letter-spacing:.6px;
  }
  .payInfobox{
    text-align:center; color:#222; font-weight:700; margin:6px 14px 14px; line-height:1.35;
  }
  .payActions{
    display:flex; gap:12px; padding: 0 16px 18px 16px;
  }
  .btn{
    flex:1; border-radius:12px; padding:14px 16px; font-weight:800; font-size:16px; border:0;
    transition: transform var(--t), background var(--t), color var(--t);
  }
  .btnGhost{ background:#efefef }
  .btnPrimary{ background:#000; color:#fff }
  .btn:active{ transform:translateY(1px) }
  .otherAmount{
    text-align:center; padding-bottom:22px; color:#007aff; font-weight:700; font-size:14px;
  }

  /* thin helpers */
  .muted{ color:var(--muted) }
  .right{ margin-left:auto }
  .learn{ color:#9aa4ff; font-weight:700; font-size:13px }

  /* Navigation between screens */
  /* 0: wallet, 1: card, 2: (unused) */
  .pos-0 .screens{ transform: translateX(0%) }
  .pos-1 .screens{ transform: translateX(-33.3333%) }

  /* Tap feedback */
  .press{ transition: transform 120ms ease }
  .press:active{ transform: scale(.98) }

  /* iOS safe area padding */
  .pb-safe{ padding-bottom: env(safe-area-inset-bottom) }
  .pt-safe{ padding-top: calc(env(safe-area-inset-top) + 2px) }

  /* small icons */
  .ico{ display:inline-block; width:18px; height:18px }
  .ico svg{ width:100%; height:100% }

  .chip{ display:inline-flex; gap:8px; align-items:center }

  /* subtle link */
  a { color: inherit; text-decoration:none }

  /* Smooth global transitions */
  .tile, .walletCard, .payBtn, .btn, .panel, .dim, .iconBtn, .bars i, .bigCard{
    will-change: transform, opacity, background, color;
  }
</style>
</head>
<body>
<div class="app pos-0" id="app">
  <!-- Sliding screens -->
  <div class="screens">

    <!-- Screen 0: Wallet -->
    <section class="screen" id="wallet">
      <div class="nav pt-safe">
        <h1>Wallet</h1>
        <div class="iconbar">
          <div class="iconBtn" aria-label="Add">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#fff" opacity=".9"><path d="M11 5h2v14h-2zM5 11h14v2H5z"/></svg>
          </div>
          <div class="iconBtn" aria-label="More">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#fff" opacity=".9"><circle cx="5" cy="12" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="19" cy="12" r="2"/></svg>
          </div>
        </div>
      </div>

      <div class="walletStack">
        <!-- Card 1 -->
        <div class="walletCard applecard press openCard" tabindex="0">
          <div class="cardChrome">
            <svg class="appleLogo" viewBox="0 0 256 256" fill="#ffffff">
              <path d="M213 173c-6 14-10 23-20 37-13 19-31 43-55 44-13 0-22-4-33-9-8-3-18-8-33-8-15 0-25 5-34 8-3 1-7 3-11 3-19 0-36-20-49-39C22 186 31 156 47 131 59 113 76 98 97 97c12 0 22 5 31 9 8 4 16 8 27 8 15 0 26-6 35-10 7-3 13-6 20-6 3 0 27 1 43 21-1 1-23 14-17 54zM171 21c0 12-5 24-11 33-9 13-23 22-38 21-1-10 4-24 11-33 8-12 25-23 38-21z"/>
            </svg>
            <svg class="brandDots" width="96" height="60" viewBox="0 0 96 60">
              <circle cx="56" cy="40" r="18" fill="none" stroke="rgba(255,255,255,.7)" stroke-width="3"/>
              <circle cx="74" cy="40" r="18" fill="none" stroke="rgba(255,255,255,.7)" stroke-width="3"/>
            </svg>
            <div class="walletLabel">Apple&nbsp;Card</div>
          </div>
        </div>

        <!-- Card 2 (stacked, also Apple Card as requested) -->
        <div class="walletCard applecard press openCard" tabindex="0" style="filter:saturate(.95) brightness(.97)">
          <div class="cardChrome">
            <svg class="appleLogo" viewBox="0 0 256 256" fill="#ffffff">
              <path d="M213 173c-6 14-10 23-20 37-13 19-31 43-55 44-13 0-22-4-33-9-8-3-18-8-33-8-15 0-25 5-34 8-3 1-7 3-11 3-19 0-36-20-49-39C22 186 31 156 47 131 59 113 76 98 97 97c12 0 22 5 31 9 8 4 16 8 27 8 15 0 26-6 35-10 7-3 13-6 20-6 3 0 27 1 43 21-1 1-23 14-17 54zM171 21c0 12-5 24-11 33-9 13-23 22-38 21-1-10 4-24 11-33 8-12 25-23 38-21z"/>
            </svg>
            <svg class="brandDots" width="96" height="60" viewBox="0 0 96 60">
              <circle cx="56" cy="40" r="18" fill="none" stroke="rgba(255,255,255,.7)" stroke-width="3"/>
              <circle cx="74" cy="40" r="18" fill="none" stroke="rgba(255,255,255,.7)" stroke-width="3"/>
            </svg>
            <div class="walletLabel">Apple&nbsp;Card</div>
          </div>
        </div>
      </div>

      <div class="tapHint">Tap a card to open its details</div>
    </section>

    <!-- Screen 1: Card Dashboard -->
    <section class="screen" id="card">
      <div class="nav pt-safe">
        <button class="pillButton" id="doneBtn">Done</button>
        <div class="iconbar">
          <div class="iconBtn" title="Search">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="#fff"><path opacity=".9" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 10-.7.7l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
          </div>
          <div class="iconBtn" title="Statements">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="#fff"><path opacity=".9" d="M4 4h16v2H4zM4 9h16v2H4zM4 14h11v2H4zM4 19h11v2H4z"/></svg>
          </div>
          <div class="iconBtn" title="More">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff" opacity=".95"><circle cx="12" cy="5" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="12" cy="19" r="2"/></svg>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="bigCard">
          <svg class="appleLogo" viewBox="0 0 256 256" fill="#ffffff">
            <path d="M213 173c-6 14-10 23-20 37-13 19-31 43-55 44-13 0-22-4-33-9-8-3-18-8-33-8-15 0-25 5-34 8-3 1-7 3-11 3-19 0-36-20-49-39C22 186 31 156 47 131 59 113 76 98 97 97c12 0 22 5 31 9 8 4 16 8 27 8 15 0 26-6 35-10 7-3 13-6 20-6 3 0 27 1 43 21-1 1-23 14-17 54zM171 21c0 12-5 24-11 33-9 13-23 22-38 21-1-10 4-24 11-33 8-12 25-23 38-21z"/>
          </svg>
          <svg class="brandDots" width="106" height="66" viewBox="0 0 96 60">
            <circle cx="56" cy="40" r="18" fill="none" stroke="rgba(255,255,255,.8)" stroke-width="3"/>
            <circle cx="74" cy="40" r="18" fill="none" stroke="rgba(255,255,255,.8)" stroke-width="3"/>
          </svg>
        </div>

        <div class="grid">
          <div class="tile">
            <div class="kb">Card Balance</div>
            <div class="chip">
              <div class="val" id="cardBalance">$181.43</div>
            </div>
            <div class="kb" style="margin-top:4px"><span class="muted">$11,497.27 Available</span></div>
          </div>

          <div class="tile">
            <div class="kb">Payment Due In</div>
            <div class="val">1 Week</div>
            <div class="right" style="margin-top:-46px">
              <button class="payBtn" id="openPay">Pay</button>
            </div>
          </div>

          <div class="tile">
            <div class="kb">Weekly Activity</div>
            <div class="kb">+ $0.00 Daily Cash</div>
            <div class="bars" aria-hidden="true">
              <i style="height:20px"></i><i style="height:28px"></i><i style="height:16px"></i>
              <i style="height:24px"></i><i style="height:18px"></i><i style="height:26px"></i><i style="height:12px"></i>
            </div>
          </div>

          <div class="tile">
            <div class="kb">Savings Account</div>
            <div class="val">$70.19</div>
          </div>

          <div class="tile full">
            <div style="display:flex; align-items:center; gap:10px;">
              <div class="badge">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="#fff" opacity=".85"><path d="M12 1l3 7h7l-5.5 4.2L18.9 20 12 15.8 5.1 20 7.5 12.2 2 8h7z"/></svg>
              </div>
              <div>
                <div class="title">Exclusive Offers with Apple&nbsp;Pay</div>
                <div class="sub">Enjoy special offers on travel, summer styles, entertainment, and more.</div>
              </div>
              <span class="right"></span>
            </div>
          </div>

          <div class="tile full">
            <div class="kb" style="margin-bottom:8px">Latest Card Transactions</div>
            <div class="list">
              <div class="row">
                <div class="badge">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="#fff"><path d="M16 3H8C5.8 3 4 4.8 4 7v10c0 2.2 1.8 4 4 4h8c2.2 0 4-1.8 4-4V7c0-2.2-1.8-4-4-4z"/></svg>
                </div>
                <div style="flex:1">
                  <div class="title">Apple Store <span class="muted">â€¢ Refund</span></div>
                  <div class="sub">7/14/23</div>
                </div>
                <div class="title">+ $40.35</div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- (extra slot reserved for future) -->
    <section class="screen"></section>
  </div>

  <!-- Pay Sheet -->
  <div class="sheet" id="sheet">
    <div class="dim" id="dim"></div>
    <div class="panel pb-safe" role="dialog" aria-modal="true" aria-label="Choose Amount">
      <div class="payHeader">Choose Amount</div>
      <div class="subDue" id="dueLine">Make payments by 11:59 PM on July 31.</div>
      <div class="ringWrap" id="ringWrap">
        <!-- SVG Ring -->
        <svg viewBox="0 0 320 320" id="ringSvg">
          <!-- base track -->
          <circle cx="160" cy="160" r="120" stroke="rgba(0,0,0,.08)" stroke-width="26" fill="none" />
          <!-- progress -->
          <defs>
            <linearGradient id="gradBlue" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#51c0ff"/>
              <stop offset="100%" stop-color="#0a84ff"/>
            </linearGradient>
            <linearGradient id="gradGreen" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#a8f17a"/>
              <stop offset="100%" stop-color="#34c759"/>
            </linearGradient>
            <linearGradient id="gradGray" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#e9ecef"/>
              <stop offset="100%" stop-color="#cfd8dc"/>
            </linearGradient>
            <filter id="glow">
              <feGaussianBlur stdDeviation="2" result="b"/>
              <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
          </defs>
          <circle id="progress" cx="160" cy="160" r="120"
                  stroke="url(#gradBlue)" stroke-width="26" fill="none"
                  stroke-linecap="round"
                  transform="rotate(-90 160 160)"
                  stroke-dasharray="753.98"
                  stroke-dashoffset="0"
                  filter="url(#glow)"/>
          <!-- ticks -->
          <g id="ticks" opacity=".25"></g>
          <!-- handle -->
          <circle id="handle" cx="280" cy="160" r="12" fill="#fff" stroke="#e6e6e6" stroke-width="2" />
        </svg>

        <div class="ringText" id="ringText">
          <div id="amountLabel">$181.43</div>
          <small>NO INTEREST CHARGES</small>
        </div>
      </div>
      <div class="payInfobox" id="payInfo">Pay Card Balance<br/><span style="color:#6f6f6f; font-weight:600">Paying the total amount you've spent is a great way to clear your balance and stay ahead on your finances.</span>
      </div>

      <div class="payActions">
        <button class="btn btnGhost" id="scheduleBtn">Schedule</button>
        <button class="btn btnPrimary" id="payNowBtn">Pay $181.43</button>
      </div>
      <div class="otherAmount" id="otherAmountBtn">Other Amount</div>
    </div>
  </div>
</div>

<script>
(() => {
  const app = document.getElementById('app');

  /* Navigation handling */
  document.querySelectorAll('.openCard').forEach(card => {
    card.addEventListener('click', () => app.className = 'app pos-1');
    card.addEventListener('keypress', e => { if(e.key==='Enter') app.className='app pos-1' });
  });
  document.getElementById('doneBtn').addEventListener('click', () => app.className = 'app pos-0');

  /* Pay Sheet open/close */
  const sheet = document.getElementById('sheet');
  const dim = document.getElementById('dim');
  const openPay = document.getElementById('openPay');
  const closeSheet = () => sheet.classList.remove('active');
  openPay.addEventListener('click', () => sheet.classList.add('active'));
  dim.addEventListener('click', closeSheet);
  document.addEventListener('keydown', e => { if(e.key==='Escape') closeSheet() });

  /* Amount + ring logic */
  const fullBalance = 181.43;
  const minPayment  = 149.36; // "Pay June Balance"
  let amount = fullBalance;

  const amountLabel = document.getElementById('amountLabel');
  const payNowBtn = document.getElementById('payNowBtn');
  const payInfo = document.getElementById('payInfo');

  const ringSvg = document.getElementById('ringSvg');
  const progress = document.getElementById('progress');
  const handle = document.getElementById('handle');
  const ticksGroup = document.getElementById('ticks');

  // Build small tick marks around the ring (every 12 degrees)
  const center = {x:160, y:160}, r = 120;
  for(let i=0;i<30;i++){
    const a = (i/30) * Math.PI*2;
    const x1 = center.x + Math.cos(a) * (r+18);
    const y1 = center.y + Math.sin(a) * (r+18);
    const x2 = center.x + Math.cos(a) * (r+8);
    const y2 = center.y + Math.sin(a) * (r+8);
    const line = document.createElementNS('http://www.w3.org/2000/svg','line');
    line.setAttribute('x1',x1); line.setAttribute('y1',y1);
    line.setAttribute('x2',x2); line.setAttribute('y2',y2);
    line.setAttribute('stroke','#000'); line.setAttribute('stroke-opacity','.08');
    line.setAttribute('stroke-width','4');
    ticksGroup.appendChild(line);
  }

  const circ = 2*Math.PI*r;
  progress.setAttribute('stroke-dasharray', String(circ));

  function setAmount(v, fromDrag=false){
    // clamp between min and full
    v = Math.max(Math.min(v, fullBalance), minPayment);
    amount = Number(v.toFixed(2));

    // fraction for ring between [min..full]
    const frac = (amount - minPayment) / (fullBalance - minPayment);
    const dash = circ * (1 - frac);
    progress.style.transition = fromDrag ? 'none' : 'stroke-dashoffset 260ms ease, stroke 260ms ease';
    progress.setAttribute('stroke-dashoffset', String(dash));

    // handle position
    const ang = (-90 + 360*frac) * Math.PI/180;
    const hx = center.x + Math.cos(ang) * r;
    const hy = center.y + Math.sin(ang) * r;
    handle.style.transition = fromDrag ? 'none' : 'transform 220ms ease, cx 220ms ease, cy 220ms ease';
    handle.setAttribute('cx', hx.toFixed(2));
    handle.setAttribute('cy', hy.toFixed(2));

    // center text
    amountLabel.textContent = `$${amount.toFixed(2)}`;
    payNowBtn.textContent = `Pay $${amount.toFixed(2)}`;

    // color state (gray -> green -> blue)
    // 0: at min (gray); 0.01..0.85 = green; >=0.85 = blue
    let strokeRef = 'url(#gradGreen)';
    let title = 'Pay More Toward Your Balance';
    let desc  = "Paying more of your card balance helps free up your available credit and reduces the amount to pay next month.";
    if (frac < 0.03) { strokeRef = 'url(#gradGray)'; title='Pay June Balance';
      desc="Paying your monthly balance is recommended to help keep you financially healthy and avoid interest charges."; }
    if (Math.abs(amount-fullBalance) < 0.01){ strokeRef = 'url(#gradBlue)'; title='Pay Card Balance';
      desc="Paying the total amount youâ€™ve spent is a great way to clear your balance and stay ahead on your finances."; }

    progress.setAttribute('stroke', strokeRef);
    payInfo.innerHTML = `${title}<br/><span style="color:#6f6f6f; font-weight:600">${desc}</span>`;
  }

  setAmount(fullBalance);

  // Dragging logic
  let dragging = false;
  const wrap = document.getElementById('ringWrap');

  const point = (evt) => {
    const r = wrap.getBoundingClientRect();
    const x = (evt.touches ? evt.touches[0].clientX : evt.clientX) - r.left;
    const y = (evt.touches ? evt.touches[0].clientY : evt.clientY) - r.top;
    const cx = r.width/2, cy = r.height/2;
    const dx = x - cx, dy = y - cy;
    let theta = Math.atan2(dy, dx); // -PI..PI, 0 is to the right
    theta = (theta + Math.PI/2); // rotate so -90 is top
    if(theta < 0) theta += Math.PI*2;
    const frac = theta/(Math.PI*2);
    const v = minPayment + frac*(fullBalance - minPayment);
    return v;
  };

  const startDrag = (e)=>{ dragging=true; setAmount(point(e), true); e.preventDefault(); }
  const moveDrag  = (e)=>{ if(!dragging) return; setAmount(point(e), true); }
  const endDrag   = ()=>{ dragging=false; setAmount(amount, false); }

  handle.addEventListener('mousedown', startDrag);
  handle.addEventListener('touchstart', startDrag, {passive:false});
  ringSvg.addEventListener('mousedown', startDrag);
  ringSvg.addEventListener('touchstart', startDrag, {passive:false});
  window.addEventListener('mousemove', moveDrag);
  window.addEventListener('touchmove', moveDrag, {passive:false});
  window.addEventListener('mouseup', endDrag);
  window.addEventListener('touchend', endDrag);

  // "Other Amount" prompt
  document.getElementById('otherAmountBtn').addEventListener('click', () => {
    const raw = prompt("Enter a payment amount between $" + minPayment.toFixed(2) + " and $" + fullBalance.toFixed(2), amount.toFixed(2));
    if(!raw) return;
    const v = parseFloat(raw.replace(/[^\d.]/g,''));
    if(isFinite(v)) setAmount(v);
  });

  // Fake â€œSchedule / Payâ€ actions
  document.getElementById('scheduleBtn').addEventListener('click', () => {
    alert('Scheduling is a demo in this build ðŸ‘');
  });
  payNowBtn.addEventListener('click', () => {
    alert(`Paid $${amount.toFixed(2)} (demo).`);
    closeSheet();
  });
})();
</script>
</body>
</html>
